<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<title>Accelerometer Javascript Test</title>
<meta name="viewport" content="width=device-width,user-scalable=yes" />
<style>
body {
  font-family: helvetica, arial, sans serif;
}
#bull {
  position: absolute;
  width: 50px;
  height: 50px;
  border-radius: 50px;
  -webkit-radius: 50px;
  background-color: blue;
}
#sphere {
  position: absolute;
  width: 50px;
  height: 50px;
  border-radius: 50px;
  -webkit-radius: 50px;
  background-color: red;
}
</style>
</head>

<body>
<div id="content">
    <h1>Jallikattu</h1>
    <div id="sphere"></div>
    <div id="bull"></div>
</div>
<script type="text/javascript">

var length = document.documentElement.clientWidth;
if (document.documentElement.clientHeight > length) {
  length = document.documentElement.clientHeight;
}
var collisionDetectionLength = length / 6;

var x = 0, y = 0,
    vx = 0, vy = 0,
  ax = 0, ay = 0;

var bx = 0, by = 0,
    bdx = 3, bdy = 3;

var sphere = document.getElementById("sphere");
var bull = document.getElementById("bull");

    bull.style.width = collisionDetectionLength + "px";
    bull.style.height = collisionDetectionLength + "px";

    sphere.style.width = collisionDetectionLength + "px";
    sphere.style.height = collisionDetectionLength + "px";

if (window.DeviceMotionEvent != undefined) {
  window.ondevicemotion = function(e) {
    ax = event.accelerationIncludingGravity.x * 2;
    ay = event.accelerationIncludingGravity.y * 2;
  }

  setInterval( function() {
    var landscapeOrientation = window.innerWidth/window.innerHeight > 1;
    if ( landscapeOrientation) {
      vx = vx + ay;
      vy = vy + ax;
    } else {
      vy = vy - ay;
      vx = vx + ax;
    }
    vx = vx * 0.98;
    vy = vy * 0.98;
    y = parseInt(y + vy / 50);
    x = parseInt(x + vx / 50);

    // Move bull
    var changeXDirection = Math.random() < 0.1;
    if (changeXDirection) {
      bdx = bdx * -1
    }
    var changeYDirection = Math.random() < 0.1;
    if (changeYDirection) {
      bdy = bdy * -1
    }
    bx = bx + bdx;
    by = by + bdy;

    boundingBoxCheck();

    sphere.style.top = y + "px";
    sphere.style.left = x + "px";

    bull.style.top = by + "px";
    bull.style.left = bx + "px";



  }, 25);
}


function boundingBoxCheck(){
  if (x<0) { x = 0; vx = -vx; }
  if (y<0) { y = 0; vy = -vy; }


  if (bx<0) { bx = 0; bdx = -bdx; }
  if (by<0) { by = 0; bdy = -bdy; }

  if (x>document.documentElement.clientWidth-collisionDetectionLength) { x = document.documentElement.clientWidth-collisionDetectionLength; vx = -vx; }
  if (y>document.documentElement.clientHeight-collisionDetectionLength) { y = document.documentElement.clientHeight-collisionDetectionLength; vy = -vy; }
}

</script>

</body>
</html>
